
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>Kokonur</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Yafeng Shan">
    

    
    <meta property="og:type" content="website">
<meta property="og:title" content="Kokonur">
<meta property="og:url" content="http://blog.kokonur.me/author/cuckoo/page/2/index.html">
<meta property="og:site_name" content="Kokonur">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Kokonur">
<link rel="publisher" href="110827390075659657828">

    
    <link rel="alternative" href="/atom.xml" title="Kokonur" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/favicon.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/favicon.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Kokonur" title="Kokonur"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Kokonur">Kokonur</a></h1>
				<h2 class="blog-motto">Tofu, fish and more sleep</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/toys">装备</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li>
 					
					<form class="search" action="/search/index.html" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" autocomplete="off" name="q" maxlength="20" placeholder="搜索" />
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/04/02/ldap-添加索引/" title="LDAP 添加索引" itemprop="url">LDAP 添加索引</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-04-02T06:07:10.000Z" itemprop="datePublished"> 发表于 2014-04-02</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p>通过添加索引，可以更快地实现检索，不过与此同时，索引将占用更多的内存，添加或者修改数据库因为需要更新索引需要的时间将更长，因此根据需要合理地添加索引。</p>
<p>索引语法如下：</p>
<pre><code># OLC (cn=config) form
olcDbIndex: attrlist | default indices

# indices = [pres [,approx] [,eq] [,sub] [,special]]
</code></pre><p>其具体含义可参考<a href="http://www.zytrax.com/books/ldap/apa/indeces.html" target="_blank" rel="external">Appendix A - OpenLDAP: Indexing Entries</a>，pres, approx, eq, sub分别是presence, approximate, equality, substring的缩写。</p>
<p>本系统使用的配置如下：</p>
<pre><code>dn: olcDatabase={1}hdb,cn=config
changetype: modify
add: olcDbIndex
olcDbIndex: cn,givenName,sn,displayName,mail pres,sub,eq
-
add: olcDbIndex
olcDbIndex: uidNumber,gidNumber eq
-
add: olcDbIndex
olcDbIndex: uid eq
-
add: olcDbIndex
olcDbIndex: default eq,sub
-
add: olcDbIndex
olcDbIndex: telephonenumber
</code></pre><p>通过命令<code>ldapmodify -Y EXTERNAL -H ldapi:/// -f ./olcDbIndex.ldif</code>修改将配置导入，或者已完成博客<a href="/2014/03/28/%E9%80%9A%E8%BF%87ldap-admin%E4%BF%AE%E6%94%B9openldap%E9%85%8D%E7%BD%AE/">通过LDAP Admin修改OpenLDAP配置</a>一文中操作，可通过LDAP Admin软件中<strong>Tools-&gt;Import…</strong>导入该配置。</p>
<p>注：导入配置后，数据库将自动重建索引，无需通过slapindex。</p>
<p>查询命令可参考<a href="http://www.zytrax.com/books/ldap/apa/search.html" target="_blank" rel="external">Appendix A - LDAP: Text Search Filter</a></p>
<p>参考文献：</p>
<ol>
<li><a href="http://www.zytrax.com/books/ldap/apa/indeces.html" target="_blank" rel="external">Appendix A - OpenLDAP: Indexing Entries</a></li>
<li><a href="http://www.zytrax.com/books/ldap/apa/search.html" target="_blank" rel="external">Appendix A - LDAP: Text Search Filter</a></li>
<li><a href="https://wiki.debian.org/LDAP/OpenLDAPSetup" target="_blank" rel="external">LDAP OpenLDAPSetup</a></li>
<li><a href="/2014/03/28/%E9%80%9A%E8%BF%87ldap-admin%E4%BF%AE%E6%94%B9openldap%E9%85%8D%E7%BD%AE/">通过LDAP Admin修改OpenLDAP配置</a></li>
</ol>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/Linux/">Linux</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/ldap/">ldap</a><a href="/tag/index/">index</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/04/02/ldap-添加索引/#comments" class="ds-thread-count comments-count-link" data-thread-key="493" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/04/01/ldap-for-rocket-scientists摘录/" title="LDAP for Rocket Scientists摘录" itemprop="url">LDAP for Rocket Scientists摘录</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-03-31T22:44:15.000Z" itemprop="datePublished"> 发表于 2014-04-01</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p><a href="http://www.zytrax.com/books/ldap/">原文链接</a></p>
<p>OpenLDAP under olc(On-line configuration) (cn=config) either as part of the standard installation or they can be added using this procedure or by the include statement in the slapd.conf configuration file).</p>
<p>commonName (cn)</p>
<p>surname(姓)</p>
<ul>
<li>An attribute definition includes its type (or SYNTAX), for example, a string or number, and how it behaves in certain conditions, for instance, whether comparison operations are case-sensitive or case-insensitive using what are called matchingRules (more on this later, much later).</li>
<li>entries must contain one, and only one, STRUCTURAL objectClass. A STRUCTURAL objectClass may have a SUPerior (may be part of a hierarchy) which is also STRUCTURAL and thus the hierarchy may be viewed as a single STRUCTURAL objectClass</li>
<li>entries may contain any number of AUXILIARY objectClasses.</li>
<li>Each objectclass supported by an LDAP server forms part of a collection called objectclasses which can be discovered via the subschema.</li>
</ul>
        
        
        <p class="article-more-link">
          
            <a href="/2014/04/01/ldap-for-rocket-scientists摘录/#more">阅读更多</a>
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/Linux/">Linux</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/ldap/">ldap</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/04/01/ldap-for-rocket-scientists摘录/#comments" class="ds-thread-count comments-count-link" data-thread-key="2014/04/01/ldap-for-rocket-scientists摘录/" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/03/28/通过ldap-admin修改openldap配置/" title="通过LDAP Admin修改OpenLDAP配置" itemprop="url">通过LDAP Admin修改OpenLDAP配置</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-03-28T07:32:43.000Z" itemprop="datePublished"> 发表于 2014-03-28</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p>配置OpenLDAP需要通过ldif语法编写指令，并通过命令行工具<code>ldapmodify</code>修改，使用起来非常不便，此时通过赋予<strong>cn=admin,dc=crscd,dc=org</strong> 数据库<strong>cn=config</strong>权限实现通过LDAP Admin、phpldapadmin等第三方管理软件修改OpenLDAP配置。</p>
<pre><code>cuckoo@server0:~$ echo &quot;dn: olcDatabase={0}config,cn=config
changetype: modify
add: olcAccess
olcAccess: to * by dn=&quot;cn=admin,dc=crscd,dc=org&quot; write&quot; &gt; /tmp/access.ldif

cuckoo@server0:~$ sudo ldapmodify -c -Y EXTERNAL -H ldapi:/// -f /tmp/access.ldif
SASL/EXTERNAL authentication started
SASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth
SASL SSF: 0
modifying entry &quot;olcDatabase={0}config,cn=config&quot;
</code></pre><p>此时在LDAP Admin新增配置<strong>Base: cn=config</strong>，实现对OpenLDAP配置操作。</p>
        
        
        <p class="article-more-link">
          
            <a href="/2014/03/28/通过ldap-admin修改openldap配置/#more">阅读更多</a>
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/Linux/">Linux</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/ldap/">ldap</a><a href="/tag/OpenLDAP/">OpenLDAP</a><a href="/tag/LDAP-Admin/">LDAP Admin</a><a href="/tag/ldap-config/">ldap config</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/03/28/通过ldap-admin修改openldap配置/#comments" class="ds-thread-count comments-count-link" data-thread-key="482" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/03/28/使用ldap-admin管理openldap/" title="使用LDAP Admin管理OpenLDAP" itemprop="url">使用LDAP Admin管理OpenLDAP</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-03-28T05:54:43.000Z" itemprop="datePublished"> 发表于 2014-03-28</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p><a href="http://www.ldapadmin.org/">Ldap Admin</a> is a free Windows LDAP client and administration tool for LDAP directory management. This application lets you browse, search, modify, create and delete objects on LDAP server. It also supports more complex operations such as directory copy and move between remote servers and extends the common edit functions to support specific object types (such as groups and accounts).</p>
<h3 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h3><ul>
<li>Browsing and editing of LDAP directories</li>
<li>Recursive operations on directory trees (copy, move and delete)</li>
<li>Modify operations on datasets</li>
<li>Binary attribute support</li>
<li>Schema browsing</li>
<li>Renaming of LDAP Entries</li>
<li>LDIF export and import</li>
<li>Password management (supports crypt, md5, sha, sha-crypt, samba)</li>
<li>Management of Posix Groups and Accounts</li>
<li>Management of Samba Accounts</li>
<li>Postfix MTA Support</li>
<li>LDAP SSL support (using Windows API)</li>
<li>Template support</li>
</ul>
        
        
        <p class="article-more-link">
          
            <a href="/2014/03/28/使用ldap-admin管理openldap/#more">阅读更多</a>
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/Linux/">Linux</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/ldap/">ldap</a><a href="/tag/OpenLDAP/">OpenLDAP</a><a href="/tag/LDAP-Admin/">LDAP Admin</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/03/28/使用ldap-admin管理openldap/#comments" class="ds-thread-count comments-count-link" data-thread-key="473" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/03/28/转载-openldap-installation-and-configuration-in-ubuntu-server-debian/" title="[转载] OpenLDAP Installation and Configuration in Ubuntu Server / Debian" itemprop="url">[转载] OpenLDAP Installation and Configuration in Ubuntu Server / Debian</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-03-28T02:55:29.000Z" itemprop="datePublished"> 发表于 2014-03-28</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p><a href="http://www.unixmen.com/openldap-installation-configuration-ubuntu-12-1013-0413-10-debian-67-2/">原文链接</a></p>
<p><a href="http://www.openldap.org/">OpenLDAP</a> is a free open source Light Weight Directory Access protocol developed by the OpenLDAP project. It is a platform independent protocol, so that it runs on all Linux/Unix like systems, Windows, AIX, Solaris and Android.</p>
<p>In this tutorial i am gonna to show you how to install and configure OpenLDAP server in Ubuntu 12.10 server. Though it is tested on Ubuntu 12.10, it may work on Debian too. In this how-to my testbox details are given below.</p>
<pre><code>Operating System : Ubuntu 12.10 Server
Hostname         : server.unixmen.com
IP Address       : 192.168.1.200
</code></pre><p>Replace the above values with your own scenario.</p>
        
        
        <p class="article-more-link">
          
            <a href="/2014/03/28/转载-openldap-installation-and-configuration-in-ubuntu-server-debian/#more">阅读更多</a>
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/Linux/">Linux</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/ldap/">ldap</a><a href="/tag/OpenLDAP/">OpenLDAP</a><a href="/tag/debian/">debian</a><a href="/tag/phpldapadmin/">phpldapadmin</a><a href="/tag/slapd/">slapd</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/03/28/转载-openldap-installation-and-configuration-in-ubuntu-server-debian/#comments" class="ds-thread-count comments-count-link" data-thread-key="467" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/03/28/我要做一本内容与结构分离的教科书/" title="我要做一本内容与结构分离的教科书" itemprop="url">我要做一本内容与结构分离的教科书</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-03-28T00:54:55.000Z" itemprop="datePublished"> 发表于 2014-03-28</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p>丑人多作怪，考前老想多，我的考前yy又拉开了帷幕。<br>现在的教学材料，内容是显性的，但结构和思路有种被淹没的危险。作为一个准备教学材料的人，需要组织结构+复制粘贴内容，有点麻烦。<br>我的设想是做一个库，里面是零散的知识点，像一张一张卡片一样。<br>学生看到的界面分两栏，左栏是线索和结构，右栏是内容。教师只要准备左栏，右栏直接把相应的卡片链接过来。<br>这样右栏的教学内容可以recycle&amp;reuse,效率比较高。左栏的思路也比较鲜明，不会被淹没。</p>
<p>比如上课的时候<br>左栏是<br>连接语若干字<strong>小儿时期造血有哪些特点呢？</strong><br>连接语若干字<strong>读小儿各时期和成人血液成分表，高亮的部分有哪些临床意义？</strong><br>连接语若干字<strong>什么是髓外造血？为什么小儿容易发生髓外造血？</strong><br>。。。<br>右栏是相应的材料。</p>
<p>然后课代表在做复习材料的时候<br>可以只把重要的点摘出来放在左栏<br><strong>读小儿各时期和成人血液成分表，高亮的部分有哪些临床意义？</strong><br><strong>什么是髓外造血？为什么小儿容易发生髓外造血？</strong><br>还可以适当加点题目什么的，右栏可以直接链接。</p>
<p>想先做一个小小的例子试一下，只是完全不知道如何下手该用什么工具啊。。。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/biomedical-engineering/">biomedical engineering</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/03/28/我要做一本内容与结构分离的教科书/#comments" class="ds-thread-count comments-count-link" data-thread-key="454" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/03/26/百度分享-for-wordpress-3-8/" title="百度分享 for Wordpress 3.8" itemprop="url">百度分享 for Wordpress 3.8</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-03-26T00:49:24.000Z" itemprop="datePublished"> 发表于 2014-03-26</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p><a href="http://share.baidu.com/" target="_blank" rel="external">百度分享</a>是一个提供网页地址收藏、分享及发送的WEB2.0按钮工具，借助百度分享按钮，网站的浏览者可以方便的分享内容到人人网、开心网、QQ空间、新浪微博等一系列SNS站点。 网站主可以在百度分享网站中获得分享按钮JS代码，嵌入到自己的网站，让网站链接分享到互联网各个角落！通过百度分享按钮，您的网站的浏览者可以便捷得分享您网站上的内容到人人网、开心网、qq&gt;空间、新浪微博等SNS站点进行传播，为您的网站带回更多的流量。通过百度分享按钮，您网站上的网页将更容易被百度搜索引擎所发现，从而有机会从百度搜索带回更多的流量。通过百度分享按钮，后续您还可以免费获取详尽的分享统计分析，了解网民将您网站上哪些内容分享到哪些SNS网站，每日的分享次数是多少，帮您更好得的跟踪、分析、激励用户的分享行为，为网站带来更多的流量。</p>
<p><a href="http://share.baidu.com/help/system/wordpress" target="_blank" rel="external">百度分享Wordpress官方插件</a>最新更新时间2011.09.21，代码使用百度分享2.0版式时出问题，不能使用从<a href="http://share.baidu.com/code" target="_blank" rel="external">http://share.baidu.com/code</a>获取的代码，使用不方便，特此修改。</p>
<p>主要更改：</p>
<ul>
<li>支持百度分享2.0</li>
<li>去除分享时设置分享内容还是标题</li>
<li>减少分享插件换行数，更美观</li>
</ul>
<p>插件地址：<a href="http://wordpress.org/plugins/baidushare-wp/" target="_blank" rel="external">http://wordpress.org/plugins/baidushare-wp/</a><br>源代码：<a href="https://github.com/cuckoohello/baidushare_wp" target="_blank" rel="external">https://github.com/cuckoohello/baidushare_wp</a><br>下载地址：<a href="https://github.com/cuckoohello/baidushare_wp/archive/v1.0.2.zip" target="_blank" rel="external">https://github.com/cuckoohello/baidushare_wp/archive/v1.0.2.zip</a><br>版本支持：Wordpress 2.8-3.8</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/wordpress/">wordpress</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/baidu/">baidu</a><a href="/tag/baidushare/">baidushare</a><a href="/tag/wordpress/">wordpress</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/03/26/百度分享-for-wordpress-3-8/#comments" class="ds-thread-count comments-count-link" data-thread-key="436" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/03/25/非root用户使用tcpdump、tshark、wireshark/" title="非root用户使用tcpdump、tshark、wireshark" itemprop="url">非root用户使用tcpdump、tshark、wireshark</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-03-25T09:51:22.000Z" itemprop="datePublished"> 发表于 2014-03-25</time>
    
  </p>
</header>

    <div class="article-content">
        
        <h3 id="wireshark-tshark"><a href="#wireshark-tshark" class="headerlink" title="wireshark/tshark"></a>wireshark/tshark</h3><p>Debian系统下通过<code>sudo dpkg-reconfigure wireshark-common</code>会出现下图所示的配置界面</p>
<p><img src="/uploads/2014/03/wireshark-common.jpg" alt="wireshark-common"></p>
<p>wireshark-common包中相应的postinst代码如下</p>
<pre><code>#!/bin/sh

set -e

. /usr/share/debconf/confmodule
PROGRAM=/usr/bin/dumpcap
GROUP=wireshark

if ! dpkg-statoverride --list $PROGRAM &gt; /dev/null; then
    db_get wireshark-common/install-setuid
    if [ -e &quot;$PROGRAM&quot; ]; then
        if [ &quot;$RET&quot; = &quot;false&quot; ] ; then
            chown root:root $PROGRAM
            chmod u=rwx,go=rx $PROGRAM
        else
            if ! addgroup --quiet --system $GROUP; then
                echo &quot;Executing \&quot;addgroup --quiet --system $GROUP\&quot; failed.&quot;
                echo &quot;Most probably the $GROUP group exists, but is not a system group.&quot;
                echo &quot;Please delete the existing group or re-create it as a system group and try configuring wireshark-common again.&quot;
                exit 1
            fi
            chown root:$GROUP $PROGRAM
            if which setcap &gt; /dev/null ; then
                chmod u=rwx,g=rx,o=r $PROGRAM
                if ! setcap cap_net_raw,cap_net_admin=eip $PROGRAM; then
                    echo &quot;Setting capabilities for dumpcap using Linux Capabilities failed.&quot;
                    echo &quot;Falling back to setting set-user-id bit.&quot;
                    chmod u=rwxs,g=rx,o=r $PROGRAM
                fi
            else
                chmod u=rwxs,g=rx,o=r $PROGRAM
            fi
        fi
    fi
else
    echo &quot;Preserving owner and mode for $PROGRAM set by dpkg-statoverride:&quot;
    dpkg-statoverride --list $PROGRAM
fi
</code></pre><p>我们可以看出，主要进行了如下几步操作：</p>
<ol>
<li>创建用户组wireshark</li>
<li>修改程序dumpcap属于用户组wireshark</li>
<li>设置程序dumpcap组权限读取与运行</li>
<li>设置程序dumpcap cap权限<code>cap_net_raw,cap_net_admin=eip</code></li>
</ol>
<p>普通用户需要使用tcpdump/wireshark仅需将用户加入wireshark用户组即可。</p>
<h3 id="tcpdump"><a href="#tcpdump" class="headerlink" title="tcpdump"></a>tcpdump</h3><p>tcpdump实现普通用户运行，只需执行类似wireshark-common的操作：</p>
<pre><code>PROGRAM=`which tcpdump`
GROUP=wireshark
chown root:$GROUP $PROGRAM
chmod u=rwx,g=rx,o=r $PROGRAM
setcap cap_net_raw,cap_net_admin=eip $PROGRAM
</code></pre>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/Linux/">Linux</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/linux/">linux</a><a href="/tag/tcpdump/">tcpdump</a><a href="/tag/tshark/">tshark</a><a href="/tag/wireshark/">wireshark</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/03/25/非root用户使用tcpdump、tshark、wireshark/#comments" class="ds-thread-count comments-count-link" data-thread-key="427" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/03/24/使用pdnsd解决dns污染/" title="使用pdnsd解决dns污染" itemprop="url">使用pdnsd解决dns污染</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-03-24T09:13:30.000Z" itemprop="datePublished"> 发表于 2014-03-24</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p>对于DNS污染，可以通过简单设置国外DNS解决，但是国内网站CDN会很慢，对此只能自行搭建DNS服务器，对于大部分网站，使用运行商DNS服务器解析，对于特殊域名，使用TCP协议通过Google DNS服务器解析，对于企业或者学校内部DNS解析，使用内部DNS服务器。</p>
<p>目前发现的解决方案有dnsmasq以及pdnsd两种方案，相比而言，pdnsd至少具备以下几点优势：</p>
<ul>
<li>支持DNS缓存，即便服务重启</li>
<li>配置更灵活</li>
<li>指定上级请求方式</li>
</ul>
<p>pdnsd配置文件有很多参数，这里列举一些感兴趣的备用：</p>
<ul>
<li>Global Section<ul>
<li><strong>interface=string;</strong>：指定绑定网口</li>
<li><strong>proxy_only=(on|off);</strong>：直接采用该服务器结果，不本机递归查询</li>
<li><strong>randomize_servers=(on|off);</strong></li>
<li><strong>policy=(included|excluded|simple_only|fqdn_only);</strong>：默认策略，配合include/exclude使用</li>
<li><strong>include=”.foo”,”.bar”,”.my.dom”;</strong></li>
<li><strong>exclude=”.foo”,”.bar”,”.my.dom”;</strong></li>
</ul>
</li>
</ul>
<p>示例配置：</p>
<pre><code>global {
        perm_cache=2048;
        cache_dir=&quot;/var/cache/pdnsd&quot;;
        run_as=&quot;pdnsd&quot;;
        interface=br-tinc;

        status_ctl = on;
        paranoid=on;
        query_method=tcp_only;

        min_ttl=15m;       // Retain cached entries at least 15 minutes.
        max_ttl=1w;        // One week.
        timeout=10;        // Global timeout option (10 seconds).

        // Don&apos;t enable if you don&apos;t recurse yourself, can lead to problems
        // delegation_only=&quot;com&quot;,&quot;net&quot;;
}
/* with status_ctl=on and resolvconf installed, this will work out from the box
   this is the recommended setup for mobile machines */
server {
        label=&quot;resolvconf&quot;;
}

server {
        label=&quot;cernet&quot;;
        ip = 202.112.0.23;
        proxy_only=on;
        policy = included;
        exclude = .localdomain,
                ,       .gmail.com
                        ,       .google-analytics.com
                        ,       .google.co.jp
                        ,       .google.com;
}
server {
        label=&quot;Google Public Dns&quot;;
        ip = 8.8.8.8, 8.8.4.4;
        policy = excluded;
        include =  .gmail.com
                ,       .google-analytics.com
                ,       .google.co.jp
                ,       .google.com;
}
                                                                                                               server {
        label = &quot;root-servers&quot;;
        ip =    198.41.0.4
                ,       192.228.79.201
                ,       192.33.4.12
                ,       128.8.10.90
                ,       192.203.230.10
                ,       192.5.5.241
                ,       192.112.36.4
                ,       128.63.2.53
                //      ,       192.36.148.17
                //      ,       192.58.128.30
                //      ,       193.0.14.129
                //      ,       198.32.64.12
                //      ,       202.12.27.33
                ;
        timeout = 5;
        uptest = query;
        interval = 30m;      // Test every half hour.
        ping_timeout = 300;  // 30 seconds.
        purge_cache = off;
        exclude = .localdomain;
        policy = included;
        preset = off;
}
</code></pre>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/Linux/">Linux</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/linux/">linux</a><a href="/tag/dns/">dns</a><a href="/tag/gfw/">gfw</a><a href="/tag/pdnsd/">pdnsd</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/03/24/使用pdnsd解决dns污染/#comments" class="ds-thread-count comments-count-link" data-thread-key="422" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/03/24/debian搭建strongswan搭建-ikev1-ikev2-vpn服务器/" title="Debian搭建StrongSwan搭建 IKEv1 IKEv2 VPN服务器" itemprop="url">Debian搭建StrongSwan搭建 IKEv1 IKEv2 VPN服务器</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-03-24T05:57:25.000Z" itemprop="datePublished"> 发表于 2014-03-24</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p>StrongSwan软件服务器直接<code>apt-get</code>从Debian仓库获取，搭建过程、各参数含义以及客户端配置流程按照 <a href="http://zh.opensuse.org/index.php?title=SDB:Setup_Ipsec_VPN_with_Strongswan&amp;variant=zh-cn#.22strongSwan_VPN_Client.22_for_Android_4.0_.28ICS.29.2B" target="_blank" rel="external">OpenSuse SDB:Setup Ipsec VPN with Strongswan</a>即可。</p>
<p>一些注意事项：</p>
<ul>
<li>Debian安装StrongSwan服务器<ul>
<li><code>sudo apt-get install strongswan  libcharon-extra-plugins -y</code><ul>
<li>无需安装strongswan-ikev、strongswan-ikev1、strongswan-ikev2，新版本中已用charon替代</li>
<li>必须安装libcharon-extra-plugins，其中包含xauth-generic、eap-radius、eap-mschapv2等认证</li>
</ul>
</li>
</ul>
</li>
<li>证书生成部分必须使用你的服务器URL或者IP地址</li>
<li>pkcs12 证书可不生成，该证书仅在使用networkmanager-strongswan配置连接时使用，该方式更安全但客户端配置时必须导入证书，不便直接使用</li>
<li>调试结束后，将strongswan.conf配置文件中filelog等级default设置为1或者0，否则日志文件将快速增长<ul>
<li>default 是默认日志级别：-1,0,1,2,3,4。-1 是完全没有日志; 0 只告诉你连接建立、连接关闭; 1 只输出错误提示; 2 会输出错误、警告和调试信息; 3 会把连接传输的数据也打印; 4 则会把密钥内容这些敏感数据也打印。一般情况下，1 或 2 都可以。</li>
</ul>
</li>
</ul>
<p>bugs:</p>
<ul>
<li><a href="http://wiki.strongswan.org/issues/431" target="_blank" rel="external">rekeying of tunnels sometimes fail with “unable to install policy … for reqid Y, the same policy for reqid X exists”</a><ul>
<li>The SA is deleted using a DELETE payload within an INFORMATIONAL exchange sent under the old IKE_SA - but HostA has no knowledge of this SA, so it doesn’t respond. Therefore, the regular retransmission timeouts apply, that is, it takes 2.75 minutes, by default, until the SA is finally destroyed and the installed IPsec policies are removed. Until that happens the new policies are declined with the observed error message.</li>
</ul>
</li>
</ul>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/Linux/">Linux</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/ipsec/">ipsec</a><a href="/tag/linux/">linux</a><a href="/tag/strongswan/">strongswan</a><a href="/tag/vpn/">vpn</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/03/24/debian搭建strongswan搭建-ikev1-ikev2-vpn服务器/#comments" class="ds-thread-count comments-count-link" data-thread-key="417" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/author/cuckoo/"><span></span>Prev</a><a class="page-number" href="/author/cuckoo/">1</a><span class="page-number current">2</span><a class="page-number" href="/author/cuckoo/page/3/">3</a><a class="page-number" href="/author/cuckoo/page/4/">4</a><a class="page-number" href="/author/cuckoo/page/5/">5</a><a class="extend next" rel="next" href="/author/cuckoo/page/3/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/category/Gentoo/" title="Gentoo">Gentoo<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/category/LDAP/" title="LDAP">LDAP<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/category/Linux/" title="Linux">Linux<sup>16</sup></a></li>
		  
		
		  
			<li><a href="/category/NAS/" title="NAS">NAS<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/category/Travel/" title="Travel">Travel<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/category/Uncategorized/" title="Uncategorized">Uncategorized<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/category/Vim/" title="Vim">Vim<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/category/WSO2/" title="WSO2">WSO2<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/category/biomedical-engineering/" title="biomedical engineering">biomedical engineering<sup>10</sup></a></li>
		  
		
		  
			<li><a href="/category/bugs-vs-drugs/" title="bugs vs drugs">bugs vs drugs<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/category/itching-for-a-solution/" title="itching for a solution">itching for a solution<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/category/meta/" title="meta">meta<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/category/pieces-of-mechanisms/" title="pieces of mechanisms">pieces of mechanisms<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/category/sdr/" title="sdr">sdr<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/category/wordpress/" title="wordpress">wordpress<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/category/文献阅读/" title="文献阅读">文献阅读<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/category/碎碎念/" title="碎碎念">碎碎念<sup>11</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tag/ldap/" title="ldap">ldap<sup>9</sup></a></li>
			
		
			
				<li><a href="/tag/OpenLDAP/" title="OpenLDAP">OpenLDAP<sup>7</sup></a></li>
			
		
			
				<li><a href="/tag/IS/" title="IS">IS<sup>3</sup></a></li>
			
		
			
				<li><a href="/tag/wso2/" title="wso2">wso2<sup>3</sup></a></li>
			
		
			
				<li><a href="/tag/linux/" title="linux">linux<sup>3</sup></a></li>
			
		
			
				<li><a href="/tag/startssl/" title="startssl">startssl<sup>2</sup></a></li>
			
		
			
				<li><a href="/tag/LDAP-Admin/" title="LDAP Admin">LDAP Admin<sup>2</sup></a></li>
			
		
			
				<li><a href="/tag/travel/" title="travel">travel<sup>2</sup></a></li>
			
		
			
				<li><a href="/tag/ufw/" title="ufw">ufw<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/apache/" title="apache">apache<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/strongswan/" title="strongswan">strongswan<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/vpn/" title="vpn">vpn<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/regex-dnsmasq-ipset/" title="regex dnsmasq ipset">regex dnsmasq ipset<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/gdb/" title="gdb">gdb<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/build-gnuradio/" title="build-gnuradio">build-gnuradio<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/gnuradio/" title="gnuradio">gnuradio<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/https/" title="https">https<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/index/" title="index">index<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/grunt/" title="grunt">grunt<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/grunt-cli/" title="grunt-cli">grunt-cli<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://linuxtoy.org/" target="_blank" title="LinuxTOY">LinuxTOY</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
          <li>
            
            	<a href="http://scateu.me" target="_blank" title="Scateu&#39;s Blog">Scateu&#39;s Blog</a>
            
          </li>
        
          <li>
            
            	<a href="https://www.byvoid.com/" target="_blank" title="BYVoid&#39;s Blog">BYVoid&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Yafeng Shan. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/cuckoohello" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		<a href="https://www.facebook.com/yafeng.shan" target="_blank" class="icon-facebook" title="facebook"></a>
		
		
		
		
		
		<a href="https://plus.google.com/110827390075659657828?rel=author" target="_blank" class="icon-google_plus" title="Google+"></a>
		
		
		<a href="mailto:cuckoo@kokonur.me" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		
				<div class="cc-license">
          <a href="http://creativecommons.org/licenses/by-nc-sa/4.0" class="cc-opacity" target="_blank">
            <img src="/img/cc-by-nc-sa.svg" alt="Creative Commons" />
          </a>
        </div>
    

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2016 
		
		<a href="/about" target="_blank" title="Yafeng Shan">Yafeng Shan</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>




<script type="text/javascript">
  var duoshuoQuery = {short_name:"kokonur"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-63496916-1', 'blog.kokonur.me');  
ga('send', 'pageview');
</script>





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
