
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>Kokonur</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Yafeng Shan">
    

    
    <meta property="og:type" content="website">
<meta property="og:title" content="Kokonur">
<meta property="og:url" content="http://blog.kokonur.me/author/cuckoo/index.html">
<meta property="og:site_name" content="Kokonur">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Kokonur">
<link rel="publisher" href="110827390075659657828">

    
    <link rel="alternative" href="/atom.xml" title="Kokonur" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/favicon.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/favicon.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Kokonur" title="Kokonur"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Kokonur">Kokonur</a></h1>
				<h2 class="blog-motto">Tofu, fish and more sleep</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/toys">装备</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li>
 					
					<form class="search" action="/search/index.html" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" autocomplete="off" name="q" maxlength="20" placeholder="搜索" />
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/10/29/dnsmasq添加正则表达式支持/" title="dnsmasq添加正则表达式支持" itemprop="url">dnsmasq添加正则表达式支持</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2015-10-29T14:56:51.000Z" itemprop="datePublished"> 发表于 2015-10-29</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p>dnsmasq可通过<a href="http://ipset.netfilter.org/" target="_blank" rel="external">ipset</a>配合iptables实现真正意义上路由层级的按域名访问，此乃真神器也！</p>
<p>但是现在很多网站使用CDN服务，例如facebook与microsoft均使用akamai的服务，所有akamai的访问均走服务器显然没有必要，此时如果dnsmasq支持regex将使ipset如虎添翼。</p>
<p>当前网上已存在针对域名解析server的regex支持，但是没有提供相应ipset的支持，因此以此为基础增加了ipset对regex的支持，源代码托管于<a href="https://github.com/cuckoohello/dnsmasq-regex" target="_blank" rel="external">dnsmasq-regex</a>，并添加debian编译相关配置文件。</p>
<p>正则表达式部分通过libpcre实现，支持标准语法，为与常规域名分开，首尾使用<code>:</code>分隔，示例如下：<br><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ipset=/:^fbcdn-[a-z<span class="symbol">\-</span>]+<span class="symbol">\.</span>akamaihd<span class="symbol">\.</span>net$:/vpn</div><div class="line">server=/:^fbcdn-[a-z<span class="symbol">\-</span>]+<span class="symbol">\.</span>akamaihd<span class="symbol">\.</span>net$:/8.8.8.8</div></pre></td></tr></table></figure></p>
<p>最后提供openwrt下编译文件<a href="https://github.com/cuckoohello/openwrt-packages/tree/master/dnsmasq" target="_blank" rel="external">openwrt-dnsmasq-makefile</a>。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/Linux/">Linux</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/regex-dnsmasq-ipset/">regex dnsmasq ipset</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2015/10/29/dnsmasq添加正则表达式支持/#comments" class="ds-thread-count comments-count-link" data-thread-key="2015/10/29/dnsmasq添加正则表达式支持/" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/08/04/ufw开启端口转发/" title="UFW开启端口转发" itemprop="url">UFW开启端口转发</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-08-04T04:50:50.000Z" itemprop="datePublished"> 发表于 2014-08-04</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p>编辑 <code>/etc/default/ufw</code> 设置<code>DEFAULT_FORWARD_POLICY</code>为 <code>ACCEPT</code>:</p>
<pre><code># Set the default forward policy to ACCEPT, DROP or REJECT.  Please note that
# if you change this you will most likely want to adjust your rules
DEFAULT_FORWARD_POLICY=&quot;ACCEPT&quot;
</code></pre><p>参考：<br>1. <a href="http://askubuntu.com/questions/161346/how-to-configure-ufw-to-allow-ip-forwarding" target="_blank" rel="external">How to configure UFW to allow IP Forwarding?</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/Linux/">Linux</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/ip-forward/">ip forward</a><a href="/tag/ufw/">ufw</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/08/04/ufw开启端口转发/#comments" class="ds-thread-count comments-count-link" data-thread-key="559" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/05/19/npm-install-grunt-cli-error/" title="npm install grunt-cli error" itemprop="url">npm install grunt-cli error</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-05-19T02:46:24.000Z" itemprop="datePublished"> 发表于 2014-05-19</time>
    
  </p>
</header>

    <div class="article-content">
        
        <h4 id="错误信息"><a href="#错误信息" class="headerlink" title="错误信息"></a>错误信息</h4><pre><code>206 error Error: ENOENT, utime &apos;/home/cuckoo/Project/ContactManager/node_modules/grunt-cli/node_modules/findup-sync/README.md&apos;
207 error If you need help, you may report this *entire* log,
207 error including the npm and node versions, at:
207 error     &lt;http://github.com/npm/npm/issues&gt;
208 error System Linux 3.12-1-amd64
209 error command &quot;/usr/bin/nodejs&quot; &quot;/usr/bin/npm&quot; &quot;install&quot; &quot;grunt-cli&quot;
210 error cwd /home/cuckoo/Project/ContactManager
211 error node -v v0.10.26
212 error npm -v 1.4.4
213 error path /home/cuckoo/Project/ContactManager/node_modules/grunt-cli/node_modules/findup-sync/README.md
214 error fstream_path /home/cuckoo/Project/ContactManager/node_modules/grunt-cli/node_modules/findup-sync/README.md
215 error fstream_type File
216 error fstream_class FileWriter
217 error fstream_finish_call utimes
218 error code ENOENT
219 error errno 34
220 error fstream_stack /usr/lib/nodejs/fstream/lib/writer.js:305:19
220 error fstream_stack Object.oncomplete (fs.js:107:15)
221 verbose exit [ 34, true ]
</code></pre><h4 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rm ~/.npm/grunt-cli -r</div></pre></td></tr></table></figure>
<p>然后再重新运行<code>npm install grunt-cli</code>安装。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/Linux/">Linux</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/grunt/">grunt</a><a href="/tag/grunt-cli/">grunt-cli</a><a href="/tag/npm/">npm</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/05/19/npm-install-grunt-cli-error/#comments" class="ds-thread-count comments-count-link" data-thread-key="546" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/05/15/编写udev规则/" title="编写udev规则" itemprop="url">编写udev规则</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-05-15T15:28:02.000Z" itemprop="datePublished"> 发表于 2014-05-15</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p>一篇非常好的文章：<a href="http://www.reactivated.net/writing_udev_rules.html" target="_blank" rel="external">http://www.reactivated.net/writing_udev_rules.html</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/Linux/">Linux</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/udev/">udev</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/05/15/编写udev规则/#comments" class="ds-thread-count comments-count-link" data-thread-key="544" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/04/11/gnuradio教育网镜像国内镜像/" title="Gnuradio教育网镜像/国内镜像" itemprop="url">Gnuradio教育网镜像/国内镜像</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-04-11T02:33:01.000Z" itemprop="datePublished"> 发表于 2014-04-11</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p>脚本下载地址<a href="http://git.kokonur.me/build-gnuradio-kokonur" target="_blank" rel="external">build-gnuradio-kokonur</a></p>
<p>如果需要脚本<a href="http://git.kokonur.me/gnuradio.sh" target="_blank" rel="external">gnuradio.sh</a>生成本地镜像</p>
<h4 id="注意事项："><a href="#注意事项：" class="headerlink" title="注意事项："></a>注意事项：</h4><ul>
<li><a href="git://gnuradio.org/jblum.git" target="_blank" rel="external">git://gnuradio.org/jblum.git</a>下载不了…</li>
<li>脚本每天凌晨3点自动更新</li>
</ul>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/sdr/">sdr</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/build-gnuradio/">build-gnuradio</a><a href="/tag/gnuradio/">gnuradio</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/04/11/gnuradio教育网镜像国内镜像/#comments" class="ds-thread-count comments-count-link" data-thread-key="514" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/04/09/apache-代理-wso2-identity-server/" title="Apache 代理 WSO2 Identity Server" itemprop="url">Apache 代理 WSO2 Identity Server</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-04-09T03:08:40.000Z" itemprop="datePublished"> 发表于 2014-04-09</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p>WSO2 Identity Server默认使用9443端口，且内置SSL，这里我们使用Apache代理IS服务器，代理时使用StartSSL的Class1免费SSL，配置如下：<br>
        
        
        <p class="article-more-link">
          
            <a href="/2014/04/09/apache-代理-wso2-identity-server/#more">阅读更多</a>
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/WSO2/">WSO2</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/apache/">apache</a><a href="/tag/https/">https</a><a href="/tag/identity-server/">identity server</a><a href="/tag/IS/">IS</a><a href="/tag/wso2/">wso2</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/04/09/apache-代理-wso2-identity-server/#comments" class="ds-thread-count comments-count-link" data-thread-key="510" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/04/08/wso2-identity-server连接ldaps/" title="WSO2 Identity Server连接ldaps" itemprop="url">WSO2 Identity Server连接ldaps</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-04-08T14:11:13.000Z" itemprop="datePublished"> 发表于 2014-04-08</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p>在文章<a href="/2014/04/08/%E8%BD%AC%E8%BD%BD-configuring-openldap-as-external-user-store-of-wso2-is-4-6-0/">Configuring OpenLDAP as external user store of WSO2 IS 4.6.0</a>一文中使用ldap连接数据库，当设置成ldaps时，将产生如下错误信息：</p>
<pre><code>[2014-04-08 13:23:34,237] ERROR {org.wso2.carbon.user.core.ldap.LDAPConnectionContext} -  Error obtaining connection. simple bind failed: ldap.crscd.org:636
javax.naming.CommunicationException: simple bind failed: ldap.crscd.org:636 [Root exception is javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.s
ecurity.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target]
</code></pre><p>此时需要导入OpenLDAP服务器相对应的CA证书，本系统使用StartSSL Class1的免费证书，因此需要导入StartSSL的根证书。<br>
        
        
        <p class="article-more-link">
          
            <a href="/2014/04/08/wso2-identity-server连接ldaps/#more">阅读更多</a>
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/WSO2/">WSO2</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/IS/">IS</a><a href="/tag/wso2/">wso2</a><a href="/tag/ldap/">ldap</a><a href="/tag/ldaps/">ldaps</a><a href="/tag/OpenLDAP/">OpenLDAP</a><a href="/tag/startssl/">startssl</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/04/08/wso2-identity-server连接ldaps/#comments" class="ds-thread-count comments-count-link" data-thread-key="508" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/04/08/转载-configuring-openldap-as-external-user-store-of-wso2-is-4-6-0/" title="[转载] Configuring OpenLDAP as external user store of WSO2 IS 4.6.0" itemprop="url">[转载] Configuring OpenLDAP as external user store of WSO2 IS 4.6.0</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-04-08T08:05:10.000Z" itemprop="datePublished"> 发表于 2014-04-08</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p><a href="http://pavithramadurangi.blogspot.nl/2013/09/configuring-openldap-as-external-user.html">原文链接</a><br><a href="https://docs.wso2.org/display/IS460/Configuring+Primary+User+Stores">官方文档</a></p>
<p>By default WSO2 IS uses embedded ldap, which is shipped with the product, as the primary user store. But it’s possible to configure other user stores (such as OpenLDAP, Active Directory and JDBC user stores) as primary user store. In this blog post I’m going to explain how to configure OpenLDAP as the primary user store of WSO2 IS 4.5.0 in following modes.</p>
<ul>
<li>Read/Write mode</li>
<li>Read-only mode</li>
</ul>
<p>Since we no longer need embedded ldap, let’s disable starting it at server start up. This can be changed in IS_HOME/repository/conf/embedded-ldap.xml</p>
<pre><code>&lt;EmbeddedLDAP&gt;
    &lt;Property name=&quot;enable&quot;&gt;false&lt;/Property&gt;
    .......................
  &lt;/EmbeddedLDAP&gt;
</code></pre>
        
        
        <p class="article-more-link">
          
            <a href="/2014/04/08/转载-configuring-openldap-as-external-user-store-of-wso2-is-4-6-0/#more">阅读更多</a>
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/WSO2/">WSO2</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/IS/">IS</a><a href="/tag/wso2/">wso2</a><a href="/tag/ldap/">ldap</a><a href="/tag/OpenLDAP/">OpenLDAP</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/04/08/转载-configuring-openldap-as-external-user-store-of-wso2-is-4-6-0/#comments" class="ds-thread-count comments-count-link" data-thread-key="506" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/04/03/转载-groupofnames-vs-groupofuniquenames区别/" title="[转载] groupOfNames vs groupOfUniqueNames区别" itemprop="url">[转载] groupOfNames vs groupOfUniqueNames区别</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-04-03T05:57:55.000Z" itemprop="datePublished"> 发表于 2014-04-03</time>
    
  </p>
</header>

    <div class="article-content">
        
        <p><a href="http://www.openldap.org/lists/openldap-software/200308/msg00073.html" target="_blank" rel="external">原文链接</a></p>
<ul>
<li>groupofnames stores its members in the member attribute (using DN as the value)</li>
<li>groupofuniquenames stores its members in the uniquemember attribute (again using DN as value).</li>
<li><strong>The uniquemember attribute however is designed to be able to hold an extra unique identifier to tell the difference between two DN’s who have the same value in a group</strong>. The reason why this might happen is that a user is deleted from the directory, but not from all of the groups. Later a new entry is added with the same DN, but it is a different person. This person needs access to the group, but you need a way to differentiate between this recent addition and the earlier DN (if you have several thousand members, simply deleting the earlier DN may not be a reasonable option).</li>
</ul>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/LDAP/">LDAP</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/ldap/">ldap</a><a href="/tag/OpenLDAP/">OpenLDAP</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/04/03/转载-groupofnames-vs-groupofuniquenames区别/#comments" class="ds-thread-count comments-count-link" data-thread-key="497" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/04/02/使用startssl-class-1证书加密openldap/" title="使用StartSSL Class 1证书加密OpenLDAP" itemprop="url">使用StartSSL Class 1证书加密OpenLDAP</a>
  </h1>
  <p class="article-author">By
    
    <a href="/author/cuckoo" title="Yafeng Shan" target="_blank" itemprop="author">Yafeng Shan</a>
    
  <p class="article-time">
    <time datetime="2014-04-02T07:01:01.000Z" itemprop="datePublished"> 发表于 2014-04-02</time>
    
  </p>
</header>

    <div class="article-content">
        
        <h3 id="服务器修改"><a href="#服务器修改" class="headerlink" title="服务器修改"></a>服务器修改</h3><p>首先配置服务器只能本地非加密访问，远程访问必须通过SSL，修改文件<code>/etc/default/slapd</code>:</p>
<pre><code>SLAPD_SERVICES=&quot;ldap://127.0.0.1:389/ ldaps:/// ldapi:///&quot;
</code></pre><p>从<a href="https://www.startssl.com/?app=12" target="_blank" rel="external">StartSSL</a>获取相应的<strong>Web Server SSL/TLS Certificate</strong>证书，并下载StartCom Class1服务器根证书，保存在/etc/ssl/ldap目录中。</p>
<p>生成LDIF配置文件并导入</p>
<pre><code>root@server0:/tmp# cat olcSSL.ldif
dn: cn=config
add: olcTLSCACertificateFile
olcTLSCACertificateFile: /etc/ssl/ldap/sub.class1.server.ca.pem
-
add: olcTLSCertificateKeyFile
olcTLSCertificateKeyFile: /etc/ssl/ldap/ldap-key.pem
-
add: olcTLSCertificateFile
olcTLSCertificateFile: /etc/ssl/ldap/ldap-cert.pem
root@server0:/tmp# ldapmodify -Y EXTERNAL -H ldapi:/// -f ./olcSSL.ldif
SASL/EXTERNAL authentication started
SASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth
SASL SSF: 0
modifying entry &quot;cn=config&quot;
</code></pre><p>为保证密匙安全，Debian中推荐将密匙修改成用户组<code>root:ssl-cert</code>，并设置权限640，将openldap用户加入组ssl-cert</p>
<pre><code>usermod -a -G ssl-cert openldap
</code></pre><p>重启slapd服务，此时外部即可且只能通过SSL连接OpenLDAP服务器。</p>
<p>###客户端配置</p>
<p>修改LDAP Admin中配置文件，使用SSL连接，并且Host设置成域名。</p>
<h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><ol>
<li><a href="https://wiki.debian.org/LDAP/OpenLDAPSetup" target="_blank" rel="external">LDAP OpenLDAPSetup</a></li>
</ol>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/category/Linux/">Linux</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tag/ldap/">ldap</a><a href="/tag/OpenLDAP/">OpenLDAP</a><a href="/tag/startssl/">startssl</a><a href="/tag/ssl/">ssl</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		
			<a href="/2014/04/02/使用startssl-class-1证书加密openldap/#comments" class="ds-thread-count comments-count-link" data-thread-key="495" data-count-type="comments">&nbsp;</a>
		
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <span class="page-number current">1</span><a class="page-number" href="/author/cuckoo/page/2/">2</a><a class="page-number" href="/author/cuckoo/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/author/cuckoo/page/5/">5</a><a class="extend next" rel="next" href="/author/cuckoo/page/2/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/category/Gentoo/" title="Gentoo">Gentoo<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/category/LDAP/" title="LDAP">LDAP<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/category/Linux/" title="Linux">Linux<sup>16</sup></a></li>
		  
		
		  
			<li><a href="/category/NAS/" title="NAS">NAS<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/category/Travel/" title="Travel">Travel<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/category/Uncategorized/" title="Uncategorized">Uncategorized<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/category/Vim/" title="Vim">Vim<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/category/WSO2/" title="WSO2">WSO2<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/category/biomedical-engineering/" title="biomedical engineering">biomedical engineering<sup>10</sup></a></li>
		  
		
		  
			<li><a href="/category/bugs-vs-drugs/" title="bugs vs drugs">bugs vs drugs<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/category/itching-for-a-solution/" title="itching for a solution">itching for a solution<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/category/meta/" title="meta">meta<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/category/pieces-of-mechanisms/" title="pieces of mechanisms">pieces of mechanisms<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/category/sdr/" title="sdr">sdr<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/category/wordpress/" title="wordpress">wordpress<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/category/文献阅读/" title="文献阅读">文献阅读<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/category/碎碎念/" title="碎碎念">碎碎念<sup>11</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tag/ldap/" title="ldap">ldap<sup>9</sup></a></li>
			
		
			
				<li><a href="/tag/OpenLDAP/" title="OpenLDAP">OpenLDAP<sup>7</sup></a></li>
			
		
			
				<li><a href="/tag/IS/" title="IS">IS<sup>3</sup></a></li>
			
		
			
				<li><a href="/tag/wso2/" title="wso2">wso2<sup>3</sup></a></li>
			
		
			
				<li><a href="/tag/linux/" title="linux">linux<sup>3</sup></a></li>
			
		
			
				<li><a href="/tag/startssl/" title="startssl">startssl<sup>2</sup></a></li>
			
		
			
				<li><a href="/tag/LDAP-Admin/" title="LDAP Admin">LDAP Admin<sup>2</sup></a></li>
			
		
			
				<li><a href="/tag/travel/" title="travel">travel<sup>2</sup></a></li>
			
		
			
				<li><a href="/tag/ufw/" title="ufw">ufw<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/apache/" title="apache">apache<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/strongswan/" title="strongswan">strongswan<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/vpn/" title="vpn">vpn<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/regex-dnsmasq-ipset/" title="regex dnsmasq ipset">regex dnsmasq ipset<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/gdb/" title="gdb">gdb<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/build-gnuradio/" title="build-gnuradio">build-gnuradio<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/gnuradio/" title="gnuradio">gnuradio<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/https/" title="https">https<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/index/" title="index">index<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/grunt/" title="grunt">grunt<sup>1</sup></a></li>
			
		
			
				<li><a href="/tag/grunt-cli/" title="grunt-cli">grunt-cli<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://linuxtoy.org/" target="_blank" title="LinuxTOY">LinuxTOY</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
          <li>
            
            	<a href="http://scateu.me" target="_blank" title="Scateu&#39;s Blog">Scateu&#39;s Blog</a>
            
          </li>
        
          <li>
            
            	<a href="https://www.byvoid.com/" target="_blank" title="BYVoid&#39;s Blog">BYVoid&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Yafeng Shan. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/cuckoohello" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		<a href="https://www.facebook.com/yafeng.shan" target="_blank" class="icon-facebook" title="facebook"></a>
		
		
		
		
		
		<a href="https://plus.google.com/110827390075659657828?rel=author" target="_blank" class="icon-google_plus" title="Google+"></a>
		
		
		<a href="mailto:cuckoo@kokonur.me" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		
				<div class="cc-license">
          <a href="http://creativecommons.org/licenses/by-nc-sa/4.0" class="cc-opacity" target="_blank">
            <img src="/img/cc-by-nc-sa.svg" alt="Creative Commons" />
          </a>
        </div>
    

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2016 
		
		<a href="/about" target="_blank" title="Yafeng Shan">Yafeng Shan</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>




<script type="text/javascript">
  var duoshuoQuery = {short_name:"kokonur"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-63496916-1', 'blog.kokonur.me');  
ga('send', 'pageview');
</script>





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
